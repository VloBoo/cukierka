<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Регистрация</title>
</head>

<body>
    <h1>Регистрация</h1>
    Логин
    <br />
    <input id="username">
    <br />
    Почта
    <br />
    <input id="email">
    <br />
    Пароль
    <br />
    <input id="password">
    <br />
    <br />
    <button onclick="confirm()">Подтвердить</button>
    <br />
    <br />
    <a id="signin" href="/signin/">
        Войти
    </a>
    <script>
        function confirm() {
            let username = document.getElementById("username").value;
            let email = document.getElementById("email").value;
            let password = document.getElementById("password").value;
            send("CreateUser", "null", { username: username, email: email, password: password }).then((data) => {
                if (data.result == "ok") {
                    alert("Вы успешно зарегистрировали аккаунт");
                    document.location = '/signin/';
                } else {
                    alert("Не удалось зарегистрироваnm аккаунт");
                }
            });
        }

        function send(api, auth, message) {
            var requestData = {
                key: api,
                message: message,
                auth: auth
            };

            var requestOptions = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            };
            return fetch('http://localhost:8080/api/', requestOptions)
                .then(response => response.json())
                .then(data => {
                    return data
                })
                .catch(error => console.error('Ошибка при получении данных:', error));
        }
    </script>
</body>

</html>